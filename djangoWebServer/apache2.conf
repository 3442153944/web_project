<VirtualHost *:80>
    ServerAdmin webmaster@example.com
    DocumentRoot "H:/web_project"
    ServerAlias www.sunyuanling.com

    ErrorLog "G:/BtSoft/wwwlogs/127.0.0.1-error.log"
    CustomLog "G:/BtSoft/wwwlogs/127.0.0.1-access.log" combined

    <Directory "H:/web_project">
        Options FollowSymLinks
        AllowOverride All
        Require all granted
        DirectoryIndex index.php index.html index.htm
    </Directory>

    RewriteEngine On
    RewriteCond %{REQUEST_URI} ^/api/(.*)$
    RewriteRule ^/api/(.*)$ http://127.0.0.1:2233/$1 [P]

    ProxyPassReverse / http://127.0.0.1:2233/

    ProxyPass /ws/ ws://127.0.0.1:2234/ws/
    ProxyPassReverse /ws/ ws://127.0.0.1:2234/ws/

    ErrorDocument 404 /404.html

    <Files ~ (\.user.ini|\.htaccess|\.git|\.svn|\.project|LICENSE|README.md)$>
        Order allow,deny
        Deny from all
    </Files>

    Include conf/php/74.conf
</VirtualHost>

<VirtualHost *:443>
    ServerAdmin webmaster@example.com
    DocumentRoot "H:/web_project"
    ServerAlias www.sunyuanling.com
    ErrorLog "G:/BtSoft/wwwlogs/127.0.0.1-error.log"
    CustomLog "G:/BtSoft/wwwlogs/127.0.0.1-access.log" combined

    IncludeOptional conf/redirect/127.0.0.1/*.conf

    RewriteEngine On
    RewriteCond %{REQUEST_URI} ^/api/(.*)$
    RewriteRule ^/api/(.*)$ http://127.0.0.1:2233/$1 [P]

    ProxyPassReverse / http://127.0.0.1:2233/

    ProxyPass /ws/ wss://127.0.0.1:2234/ws/
    ProxyPassReverse /ws/ wss://127.0.0.1:2234/ws/

    ErrorDocument 404 /404.html

    SSLEngine On
    SSLCertificateFile conf/ssl/127.0.0.1/fullchain.pem
    SSLCertificateKeyFile conf/ssl/127.0.0.1/privkey.pem
    SSLCipherSuite EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH
    SSLProtocol All -SSLv2 -SSLv3
    SSLHonorCipherOrder On

    <Files ~ (\.user.ini|\.htaccess|\.git|\.svn|\.project|LICENSE|README.md)$>
        Order allow,deny
        Deny from all
    </Files>

    Include conf/php/74.conf

    <Directory "H:/web_project">
        Options FollowSymLinks ExecCGI
        AllowOverride All
        Require all granted
        DirectoryIndex index.php default.php index.html index.htm default.html default.htm
    </Directory>
</VirtualHost>
